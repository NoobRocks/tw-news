(this["webpackJsonptw-news"]=this["webpackJsonptw-news"]||[]).push([[0],{12:function(e,t,n){e.exports=n(18)},17:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(8),i=n.n(o),c=(n(17),n(1)),l=n(2),s=n(5),u=n(3),d=n(4),g=n(9),h=n(10),f=n(11),p={container:{display:"flex",flexDirection:"column",alignItems:"center",padding:"0 3%",width:"94%",height:"100%",overflow:"auto"}},m={container:{width:"80%",backgroundColor:"#E6437B",color:"white",padding:"14px 3%",display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px",boxShadow:"5px 5px 8px rgba(0, 0, 0, .5)",marginBottom:"20px",flexShrink:"0"},postLink:{color:"white"},image:{width:"38%",maxWidth:"38%",maxHeight:"200px",objectFit:"contain",flexShrink:"0"},detailsContainer:{width:"60%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"flex-start",wordBreak:"break-word"},dateString:{alignSelf:"flex-end",fontSize:"12px"}},b=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.author,n=e.datePublished,a=e.title,o=e.url,i=e.urlToImage,c=e.category;return r.a.createElement("div",{style:m.container},r.a.createElement("img",{style:m.image,alt:a,title:a,src:i}),r.a.createElement("div",{style:{width:"2%",flexShrink:"0"}}),r.a.createElement("div",{style:m.detailsContainer},r.a.createElement("div",null,r.a.createElement("span",null,"(",r.a.createElement("i",null,c),")"),r.a.createElement("span",null," "),r.a.createElement("span",null,r.a.createElement("b",null,t))),r.a.createElement("a",{style:m.postLink,href:o,target:"_blank",rel:"noopener noreferrer"},a),r.a.createElement("div",{style:m.dateString},n.toLocaleString())))}}]),t}(r.a.PureComponent);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(n,!0).forEach((function(t){Object(g.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v="875fb1f3a6ca49e49c04d62f7f254097",O=20,j=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).parseDate=function(e){var t=e.match(/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})Z/);return Object(h.a)(Date,Object(f.a)(t.slice(1)))},n.fetchCategory=function(e,t){return fetch("https://newsapi.org/v2/top-headlines?country=tw&apiKey=".concat(v,"&category=").concat(e,"&pageSize=").concat(O,"&page=").concat(t)).then((function(e){return e.ok&&e.json()}))},n.fetchAllCategories=function(e){var t=["entertainment","technology","sports"];return Promise.all(t.map((function(t){return n.fetchCategory(t,e)}))).then((function(e){var a=e.map((function(e,a){return e&&e.articles.map((function(e){return w({},e,{category:t[a],datePublished:n.parseDate(e.publishedAt)})}))})).filter((function(e){return!!e})).reduce((function(e,t){return e.concat(t)}),[]);return console.log("fetchedArticles.length",a.length),a}))},n.loadPage=function(e){return console.log("loadPage",e),n.fetchAllCategories(e).then((function(t){var a=n.state.articles.concat(t);a.sort((function(e,t){return t.datePublished.getTime()-e.datePublished.getTime()})),n.setState({articles:a,nextPage:t.length>0?e+1:e,pageToLoad:t.length>0?e:e-1})}))},n.goToNextPage=function(){n.setState((function(e){return{pageToLoad:e.nextPage}}))},n.onContainerScroll=function(e){e.target.scrollTop>=e.target.scrollHeight-e.target.offsetHeight&&(console.log("scrolled to bottom"),n.goToNextPage())},n.state={articles:[],pageToLoad:0,nextPage:1},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.goToNextPage()}},{key:"componentDidUpdate",value:function(e,t){t.pageToLoad!==this.state.pageToLoad&&this.state.pageToLoad===this.state.nextPage&&this.loadPage(this.state.pageToLoad)}},{key:"render",value:function(){var e=this.state.articles;return r.a.createElement("div",{style:p.container,onScroll:this.onContainerScroll},e.map((function(e,t){return r.a.createElement(b,w({key:"article_".concat(t)},e))})))}}]),t}(r.a.Component),x={container:{display:"flex",justifyContent:"center",backgroundImage:"linear-gradient(45deg, black, white 30%, white 70%, black)",backgroundSize:"cover",backgroundPosition:"center"},content:{width:"94vw",height:"100vh"}},k=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:x.container},r.a.createElement("div",{style:x.content},r.a.createElement(j,null)))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[12,1,2]]]);
//# sourceMappingURL=main.856f2c4a.chunk.js.map